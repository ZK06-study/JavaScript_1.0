# 20. ìë£Œêµ¬ì¡° - í€´ì¦ˆ

## ê°ê´€ì‹ ë¬¸ì œ

### 1. ğŸŸ¢ `Map`ê³¼ ì¼ë°˜ ê°ì²´ì˜ ì°¨ì´ì ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?
a) Mapì€ í‚¤ë¡œ ë¬¸ìì—´ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
b) Mapì€ í‚¤ë¡œ ëª¨ë“  íƒ€ì…ì˜ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
c) Mapì€ í”„ë¡œí† íƒ€ì…ì„ ê°€ì§„ë‹¤
d) Mapì€ ì´í„°ëŸ¬ë¸”ì´ ì•„ë‹ˆë‹¤

### 2. ğŸŸ¡ `Set`ì˜ íŠ¹ì§•ìœ¼ë¡œ í‹€ë¦° ê²ƒì€?
a) ì¤‘ë³µëœ ê°’ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
b) ìˆœì„œë¥¼ ìœ ì§€í•œë‹¤
c) ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤
d) ì´í„°ëŸ¬ë¸”ì´ë‹¤

### 3. ğŸŸ  `WeakMap`ì˜ íŠ¹ì§•ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?
a) í‚¤ë¡œ ì›ì‹œ íƒ€ì…ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
b) í‚¤ë¡œ ê°ì²´ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
c) ì´í„°ëŸ¬ë¸”ì´ë‹¤
d) `size` ì†ì„±ì„ ê°€ì§„ë‹¤

### 4. ğŸŸ¡ ë‹¤ìŒ ì¤‘ `Map`ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ì•„ë‹Œ ê²ƒì€?
a) `set()`
b) `get()`
c) `push()`
d) `has()`

### 5. ğŸŸ  `WeakSet`ê³¼ `Set`ì˜ ì°¨ì´ì ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?
a) WeakSetì€ ì›ì‹œ íƒ€ì…ë§Œ ì €ì¥í•  ìˆ˜ ìˆë‹¤
b) WeakSetì€ ì´í„°ëŸ¬ë¸”í•˜ë‹¤
c) WeakSetì€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆë‹¤
d) WeakSetì€ í¬ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤

### 6. ğŸŸ¡ `new Map([['a', 1], ['b', 2]])`ì˜ í¬ê¸°ëŠ”?
a) 1
b) 2
c) 3
d) 4

## ë‹¨ë‹µí˜• ë¬¸ì œ

### 7. ğŸŸ¢ `Set`ì—ì„œ ì¤‘ë³µì„ ì œê±°í•˜ë ¤ëŠ” ê°’ì„ ì¶”ê°€í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œëŠ”?

### 8. ğŸŸ¡ `Map`ì—ì„œ íŠ¹ì • í‚¤ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë©”ì„œë“œëŠ”?

### 9. ğŸŸ  `WeakMap`ê³¼ `WeakSet`ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê³µí†µ ì†ì„±ì€?

### 10. ğŸŸ¢ ë°°ì—´ì—ì„œ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€?

## ì„œìˆ í˜• ë¬¸ì œ

### 11. ğŸŸ¡ `Map`ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ê³¼ ì¼ë°˜ ê°ì²´ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì„ ë¹„êµí•˜ì—¬ ì„¤ëª…í•˜ì‹œì˜¤.

### 12. ğŸŸ  `WeakMap`ê³¼ `WeakSet`ì˜ ì‚¬ìš© ëª©ì ê³¼ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ê³¼ì˜ ê´€ê³„ë¥¼ ì„¤ëª…í•˜ì‹œì˜¤.

### 13. ğŸŸ¡ `Set`ì˜ ë‹¤ì–‘í•œ í™œìš© ë°©ë²•ê³¼ ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì„¤ëª…í•˜ì‹œì˜¤.

## ì½”ë”© ë¬¸ì œ

### 14. ğŸŸ¢ ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì‹œì˜¤.
```javascript
// 1. ë°°ì—´ì—ì„œ ì¤‘ë³µ ì œê±°
// 2. ë‘ ë°°ì—´ì˜ í•©ì§‘í•©, êµì§‘í•©, ì°¨ì§‘í•© ê³„ì‚°
const arr1 = [1, 2, 3, 4];
const arr2 = [3, 4, 5, 6];
```

### 15. ğŸŸ¡ `Map`ì„ í™œìš©í•œ ìºì‹œ ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ì‹œì˜¤.
```javascript
// LRU (Least Recently Used) ìºì‹œ
// ìµœëŒ€ í¬ê¸° ì œí•œ
// ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ìë™ ì‚­ì œ
```

### 16. ğŸŸ  `WeakMap`ì„ ì´ìš©í•œ private ë°ì´í„° ì €ì¥ì†Œë¥¼ êµ¬í˜„í•˜ì‹œì˜¤.
```javascript
// í´ë˜ìŠ¤ì˜ private ë°ì´í„°ë¥¼ WeakMapìœ¼ë¡œ ê´€ë¦¬
// ì¸ìŠ¤í„´ìŠ¤ê°€ ì‚­ì œë˜ë©´ private ë°ì´í„°ë„ ìë™ìœ¼ë¡œ ì •ë¦¬
```

### 17. ğŸŸ¡ ë‹¤ì–‘í•œ ìë£Œêµ¬ì¡°ë¥¼ í™œìš©í•œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ì„ ì‘ì„±í•˜ì‹œì˜¤.
```javascript
// 1. ë¬¸ìì—´ì—ì„œ ë¬¸ì ë¹ˆë„ìˆ˜ ê³„ì‚° (Map ì‚¬ìš©)
// 2. ë°°ì—´ì—ì„œ ìœ ë‹ˆí¬í•œ ìš”ì†Œë“¤ì˜ ê°œìˆ˜ (Set ì‚¬ìš©)
// 3. ê°ì²´ ê¹Šì€ ë¹„êµ (Setìœ¼ë¡œ ìˆœí™˜ ì°¸ì¡° ë°©ì§€)
```

## ì‘ìš© ë¬¸ì œ

### 18. ğŸŸ  ë‹¤ìŒ ì½”ë“œì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì˜ˆìƒí•˜ê³  ì„¤ëª…í•˜ì‹œì˜¤.
```javascript
const map = new Map();
const obj = {};
const arr = [];

map.set(obj, 'object');
map.set(arr, 'array');
map.set('key', 'string');

console.log(map.get({}));
console.log(map.get(obj));
console.log(map.get('key'));
console.log(map.size);
```

### 19. ğŸŸ  ê·¸ë˜í”„ ìë£Œêµ¬ì¡°ë¥¼ `Map`ê³¼ `Set`ìœ¼ë¡œ êµ¬í˜„í•˜ì‹œì˜¤.
```javascript
// ë°©í–¥ ê·¸ë˜í”„ (Directed Graph)
// ë…¸ë“œ ì¶”ê°€/ì œê±°, ì—£ì§€ ì¶”ê°€/ì œê±°
// DFS, BFS ìˆœíšŒ êµ¬í˜„
// ì‚¬ì´í´ ê²€ì¶œ
```

### 20. ğŸŸ  `Set`ê³¼ `Map`ì„ í™œìš©í•œ ê´€ê³„í˜• ë°ì´í„° ê´€ë¦¬ìë¥¼ êµ¬í˜„í•˜ì‹œì˜¤.
```javascript
// ë‹¤ëŒ€ë‹¤ ê´€ê³„ ê´€ë¦¬
// ì‚¬ìš©ìì™€ ê·¸ë£¹ ê°„ì˜ ê´€ê³„
// íš¨ìœ¨ì ì¸ ê²€ìƒ‰ê³¼ ì—…ë°ì´íŠ¸
```

---

## ì •ë‹µ

### ê°ê´€ì‹ ì •ë‹µ
1. b) Mapì€ í‚¤ë¡œ ëª¨ë“  íƒ€ì…ì˜ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
2. c) ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ (Setì€ ì¸ë±ìŠ¤ ì ‘ê·¼ ë¶ˆê°€)
3. b) í‚¤ë¡œ ê°ì²´ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
4. c) `push()` (ë°°ì—´ ë©”ì„œë“œ, Mapì—ëŠ” ì—†ìŒ)
5. c) WeakSetì€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆë‹¤
6. b) 2

### ë‹¨ë‹µí˜• ì •ë‹µ
7. `add()`
8. `has()`
9. `size` (WeakMapê³¼ WeakSetì€ size ì†ì„±ì´ ì—†ìŒ)
10. `[...new Set(array)]`

### ì„œìˆ í˜• ì •ë‹µ
11. **Map vs ê°ì²´ ì‚¬ìš© ê¸°ì¤€:**
**Map ì‚¬ìš© ì‹œ:**
- í‚¤ê°€ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°
- í‚¤-ê°’ ìŒì˜ ë¹ˆë²ˆí•œ ì¶”ê°€/ì‚­ì œ
- í¬ê¸°ë¥¼ ìì£¼ í™•ì¸í•´ì•¼ í•˜ëŠ” ê²½ìš°
- ìˆœíšŒ ìˆœì„œê°€ ì¤‘ìš”í•œ ê²½ìš°

**ê°ì²´ ì‚¬ìš© ì‹œ:**
- ë ˆì½”ë“œë‚˜ ë”•ì…”ë„ˆë¦¬ ì—­í• 
- JSONê³¼ì˜ í˜¸í™˜ì„±ì´ í•„ìš”í•œ ê²½ìš°
- ë©”ì„œë“œë‚˜ ì†ì„±ì´ í¬í•¨ëœ ê²½ìš°

12. **WeakMap/WeakSetê³¼ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜:**
- í‚¤/ê°’ì´ ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°ë˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ ì œê±°
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
- private ë°ì´í„° ì €ì¥, ë©”íƒ€ë°ì´í„° ê´€ë¦¬ì— í™œìš©
- DOM ë…¸ë“œì™€ ì—°ê´€ ë°ì´í„° ê´€ë¦¬ì— ìœ ìš©

13. **Set í™œìš© ë°©ë²•:**
- ë°°ì—´ ì¤‘ë³µ ì œê±°
- ì§‘í•© ì—°ì‚° (í•©ì§‘í•©, êµì§‘í•©, ì°¨ì§‘í•©)
- ìœ ë‹ˆí¬í•œ ê°’ë“¤ì˜ ì¶”ì 
- ìˆœí™˜ ì°¸ì¡° ê°ì§€
- íƒœê·¸ ì‹œìŠ¤í…œ, ê¶Œí•œ ê´€ë¦¬

### ì½”ë”© ì •ë‹µ
14.
```javascript
// 1. ë°°ì—´ì—ì„œ ì¤‘ë³µ ì œê±°
function removeDuplicates(arr) {
  return [...new Set(arr)];
}

// 2. ì§‘í•© ì—°ì‚°ë“¤
function setOperations(arr1, arr2) {
  const set1 = new Set(arr1);
  const set2 = new Set(arr2);
  
  // í•©ì§‘í•©
  const union = new Set([...set1, ...set2]);
  
  // êµì§‘í•©
  const intersection = new Set([...set1].filter(x => set2.has(x)));
  
  // ì°¨ì§‘í•© (set1 - set2)
  const difference = new Set([...set1].filter(x => !set2.has(x)));
  
  return {
    union: [...union],
    intersection: [...intersection],
    difference: [...difference]
  };
}

// ì‚¬ìš© ì˜ˆì‹œ
const arr1 = [1, 2, 3, 4];
const arr2 = [3, 4, 5, 6];

console.log(removeDuplicates([1, 2, 2, 3, 3, 4])); // [1, 2, 3, 4]

const result = setOperations(arr1, arr2);
console.log(result.union);        // [1, 2, 3, 4, 5, 6]
console.log(result.intersection); // [3, 4]
console.log(result.difference);   // [1, 2]
```

15.
```javascript
class LRUCache {
  constructor(maxSize) {
    this.maxSize = maxSize;
    this.cache = new Map();
  }
  
  get(key) {
    if (this.cache.has(key)) {
      // í‚¤ë¥¼ ê°€ì¥ ìµœê·¼ ì‚¬ìš©ìœ¼ë¡œ ì´ë™
      const value = this.cache.get(key);
      this.cache.delete(key);
      this.cache.set(key, value);
      return value;
    }
    return undefined;
  }
  
  set(key, value) {
    if (this.cache.has(key)) {
      // ê¸°ì¡´ í‚¤ ì—…ë°ì´íŠ¸
      this.cache.delete(key);
    } else if (this.cache.size >= this.maxSize) {
      // ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }
    
    this.cache.set(key, value);
  }
  
  has(key) {
    return this.cache.has(key);
  }
  
  delete(key) {
    return this.cache.delete(key);
  }
  
  clear() {
    this.cache.clear();
  }
  
  get size() {
    return this.cache.size;
  }
  
  keys() {
    return [...this.cache.keys()];
  }
  
  values() {
    return [...this.cache.values()];
  }
  
  entries() {
    return [...this.cache.entries()];
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const cache = new LRUCache(3);

cache.set('a', 1);
cache.set('b', 2);
cache.set('c', 3);
console.log(cache.keys()); // ['a', 'b', 'c']

cache.get('a'); // 'a'ë¥¼ ìµœê·¼ ì‚¬ìš©ìœ¼ë¡œ ì´ë™
console.log(cache.keys()); // ['b', 'c', 'a']

cache.set('d', 4); // 'b'ê°€ ì œê±°ë¨
console.log(cache.keys()); // ['c', 'a', 'd']
```

16.
```javascript
// WeakMapì„ ì´ìš©í•œ private ë°ì´í„° ì €ì¥ì†Œ
const privateData = new WeakMap();

class BankAccount {
  constructor(accountNumber, initialBalance = 0) {
    // private ë°ì´í„°ë¥¼ WeakMapì— ì €ì¥
    privateData.set(this, {
      accountNumber,
      balance: initialBalance,
      transactions: []
    });
  }
  
  deposit(amount) {
    if (amount <= 0) {
      throw new Error('ì…ê¸ˆì•¡ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.');
    }
    
    const data = privateData.get(this);
    data.balance += amount;
    data.transactions.push({
      type: 'deposit',
      amount,
      timestamp: new Date(),
      balance: data.balance
    });
    
    return data.balance;
  }
  
  withdraw(amount) {
    const data = privateData.get(this);
    
    if (amount <= 0) {
      throw new Error('ì¶œê¸ˆì•¡ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.');
    }
    if (amount > data.balance) {
      throw new Error('ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.');
    }
    
    data.balance -= amount;
    data.transactions.push({
      type: 'withdraw',
      amount,
      timestamp: new Date(),
      balance: data.balance
    });
    
    return data.balance;
  }
  
  getBalance() {
    return privateData.get(this).balance;
  }
  
  getAccountNumber() {
    return privateData.get(this).accountNumber;
  }
  
  getTransactionHistory() {
    return [...privateData.get(this).transactions];
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const account = new BankAccount('123-456-789', 1000);
console.log(account.getBalance()); // 1000

account.deposit(500);
account.withdraw(200);
console.log(account.getBalance()); // 1300

// private ë°ì´í„°ì— ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€
// console.log(account.accountNumber); // undefined
// console.log(account.balance); // undefined

// ê³„ì¢Œ ê°ì²´ê°€ ì œê±°ë˜ë©´ WeakMapì˜ ë°ì´í„°ë„ ìë™ìœ¼ë¡œ ì œê±°ë¨
```

17.
```javascript
// 1. ë¬¸ìì—´ì—ì„œ ë¬¸ì ë¹ˆë„ìˆ˜ ê³„ì‚°
function characterFrequency(str) {
  const frequency = new Map();
  
  for (const char of str) {
    frequency.set(char, (frequency.get(char) || 0) + 1);
  }
  
  return frequency;
}

// 2. ë°°ì—´ì—ì„œ ìœ ë‹ˆí¬í•œ ìš”ì†Œë“¤ì˜ ê°œìˆ˜
function countUniqueElements(arr) {
  return new Set(arr).size;
}

// 3. ê°ì²´ ê¹Šì€ ë¹„êµ (ìˆœí™˜ ì°¸ì¡° ë°©ì§€)
function deepEqual(obj1, obj2, visited = new Set()) {
  // ê°™ì€ ì°¸ì¡°ë©´ true
  if (obj1 === obj2) return true;
  
  // íƒ€ì…ì´ ë‹¤ë¥´ë©´ false
  if (typeof obj1 !== typeof obj2) return false;
  
  // null ì²´í¬
  if (obj1 === null || obj2 === null) return obj1 === obj2;
  
  // ì›ì‹œ íƒ€ì…ì´ë©´ ì§ì ‘ ë¹„êµ
  if (typeof obj1 !== 'object') return obj1 === obj2;
  
  // ìˆœí™˜ ì°¸ì¡° ì²´í¬
  if (visited.has(obj1) || visited.has(obj2)) {
    return obj1 === obj2;
  }
  
  visited.add(obj1);
  visited.add(obj2);
  
  try {
    // ë°°ì—´ ì²´í¬
    if (Array.isArray(obj1) !== Array.isArray(obj2)) return false;
    
    // í‚¤ ê°œìˆ˜ ë¹„êµ
    const keys1 = Object.keys(obj1);
    const keys2 = Object.keys(obj2);
    
    if (keys1.length !== keys2.length) return false;
    
    // ê° í‚¤ì— ëŒ€í•´ ì¬ê·€ì ìœ¼ë¡œ ë¹„êµ
    for (const key of keys1) {
      if (!keys2.includes(key)) return false;
      if (!deepEqual(obj1[key], obj2[key], visited)) return false;
    }
    
    return true;
  } finally {
    visited.delete(obj1);
    visited.delete(obj2);
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
console.log(characterFrequency('hello')); // Map {'h'=>1, 'e'=>1, 'l'=>2, 'o'=>1}
console.log(countUniqueElements([1, 2, 2, 3, 3, 4])); // 4

const obj1 = { a: 1, b: { c: 2 } };
const obj2 = { a: 1, b: { c: 2 } };
console.log(deepEqual(obj1, obj2)); // true
```

### ì‘ìš© ì •ë‹µ
18.
```javascript
// ì‹¤í–‰ ê²°ê³¼:
console.log(map.get({}));    // undefined (ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°)
console.log(map.get(obj));   // 'object' (ê°™ì€ ê°ì²´ ì°¸ì¡°)
console.log(map.get('key')); // 'string'
console.log(map.size);       // 3

// ì„¤ëª…: Mapì—ì„œ í‚¤ ë¹„êµëŠ” === ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ
// ìƒˆë¡œìš´ ë¹ˆ ê°ì²´ {}ëŠ” ê¸°ì¡´ì— ì €ì¥ëœ objì™€ ë‹¤ë¥¸ ì°¸ì¡°ì…ë‹ˆë‹¤.
```

19.
```javascript
class DirectedGraph {
  constructor() {
    this.nodes = new Set();
    this.edges = new Map(); // node -> Set of connected nodes
  }
  
  addNode(node) {
    this.nodes.add(node);
    if (!this.edges.has(node)) {
      this.edges.set(node, new Set());
    }
  }
  
  removeNode(node) {
    if (!this.nodes.has(node)) return false;
    
    this.nodes.delete(node);
    this.edges.delete(node);
    
    // ë‹¤ë¥¸ ë…¸ë“œë“¤ì—ì„œ ì´ ë…¸ë“œë¡œì˜ ì—£ì§€ ì œê±°
    for (const [_, connections] of this.edges) {
      connections.delete(node);
    }
    
    return true;
  }
  
  addEdge(from, to) {
    this.addNode(from);
    this.addNode(to);
    this.edges.get(from).add(to);
  }
  
  removeEdge(from, to) {
    if (!this.edges.has(from)) return false;
    return this.edges.get(from).delete(to);
  }
  
  hasEdge(from, to) {
    return this.edges.has(from) && this.edges.get(from).has(to);
  }
  
  getNeighbors(node) {
    return this.edges.has(node) ? [...this.edges.get(node)] : [];
  }
  
  // DFS ìˆœíšŒ
  *dfs(startNode, visited = new Set()) {
    if (!this.nodes.has(startNode) || visited.has(startNode)) return;
    
    visited.add(startNode);
    yield startNode;
    
    for (const neighbor of this.edges.get(startNode)) {
      yield* this.dfs(neighbor, visited);
    }
  }
  
  // BFS ìˆœíšŒ
  *bfs(startNode) {
    if (!this.nodes.has(startNode)) return;
    
    const visited = new Set();
    const queue = [startNode];
    visited.add(startNode);
    
    while (queue.length > 0) {
      const node = queue.shift();
      yield node;
      
      for (const neighbor of this.edges.get(node)) {
        if (!visited.has(neighbor)) {
          visited.add(neighbor);
          queue.push(neighbor);
        }
      }
    }
  }
  
  // ì‚¬ì´í´ ê²€ì¶œ (DFS ê¸°ë°˜)
  hasCycle() {
    const visited = new Set();
    const recursionStack = new Set();
    
    const dfsHasCycle = (node) => {
      visited.add(node);
      recursionStack.add(node);
      
      for (const neighbor of this.edges.get(node)) {
        if (!visited.has(neighbor)) {
          if (dfsHasCycle(neighbor)) return true;
        } else if (recursionStack.has(neighbor)) {
          return true; // ì‚¬ì´í´ ë°œê²¬
        }
      }
      
      recursionStack.delete(node);
      return false;
    };
    
    for (const node of this.nodes) {
      if (!visited.has(node)) {
        if (dfsHasCycle(node)) return true;
      }
    }
    
    return false;
  }
  
  // ê·¸ë˜í”„ ì •ë³´ ì¶œë ¥
  toString() {
    const result = [];
    for (const [node, connections] of this.edges) {
      result.push(`${node} -> [${[...connections].join(', ')}]`);
    }
    return result.join('\n');
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const graph = new DirectedGraph();

graph.addEdge('A', 'B');
graph.addEdge('A', 'C');
graph.addEdge('B', 'D');
graph.addEdge('C', 'D');
graph.addEdge('D', 'E');

console.log('DFS from A:', [...graph.dfs('A')]); // ['A', 'B', 'D', 'E', 'C']
console.log('BFS from A:', [...graph.bfs('A')]); // ['A', 'B', 'C', 'D', 'E']
console.log('Has cycle:', graph.hasCycle()); // false

// ì‚¬ì´í´ ì¶”ê°€
graph.addEdge('E', 'A');
console.log('Has cycle after adding E->A:', graph.hasCycle()); // true
```

20.
```javascript
class RelationshipManager {
  constructor() {
    this.users = new Set();
    this.groups = new Set();
    this.userToGroups = new Map(); // user -> Set of groups
    this.groupToUsers = new Map(); // group -> Set of users
  }
  
  addUser(user) {
    this.users.add(user);
    if (!this.userToGroups.has(user)) {
      this.userToGroups.set(user, new Set());
    }
  }
  
  addGroup(group) {
    this.groups.add(group);
    if (!this.groupToUsers.has(group)) {
      this.groupToUsers.set(group, new Set());
    }
  }
  
  removeUser(user) {
    if (!this.users.has(user)) return false;
    
    // ì‚¬ìš©ìê°€ ì†í•œ ëª¨ë“  ê·¸ë£¹ì—ì„œ ì œê±°
    const userGroups = this.userToGroups.get(user);
    for (const group of userGroups) {
      this.groupToUsers.get(group).delete(user);
    }
    
    this.users.delete(user);
    this.userToGroups.delete(user);
    return true;
  }
  
  removeGroup(group) {
    if (!this.groups.has(group)) return false;
    
    // ê·¸ë£¹ì— ì†í•œ ëª¨ë“  ì‚¬ìš©ìì—ì„œ ì´ ê·¸ë£¹ ì œê±°
    const groupUsers = this.groupToUsers.get(group);
    for (const user of groupUsers) {
      this.userToGroups.get(user).delete(group);
    }
    
    this.groups.delete(group);
    this.groupToUsers.delete(group);
    return true;
  }
  
  addUserToGroup(user, group) {
    this.addUser(user);
    this.addGroup(group);
    
    this.userToGroups.get(user).add(group);
    this.groupToUsers.get(group).add(user);
  }
  
  removeUserFromGroup(user, group) {
    if (!this.userToGroups.has(user) || !this.groupToUsers.has(group)) {
      return false;
    }
    
    this.userToGroups.get(user).delete(group);
    this.groupToUsers.get(group).delete(user);
    return true;
  }
  
  getUserGroups(user) {
    return this.userToGroups.has(user) ? [...this.userToGroups.get(user)] : [];
  }
  
  getGroupUsers(group) {
    return this.groupToUsers.has(group) ? [...this.groupToUsers.get(group)] : [];
  }
  
  isUserInGroup(user, group) {
    return this.userToGroups.has(user) && this.userToGroups.get(user).has(group);
  }
  
  // ê³µí†µ ê·¸ë£¹ì— ì†í•œ ì‚¬ìš©ìë“¤ ì°¾ê¸°
  findUsersInSameGroups(user) {
    if (!this.userToGroups.has(user)) return [];
    
    const userGroups = this.userToGroups.get(user);
    const relatedUsers = new Set();
    
    for (const group of userGroups) {
      const groupUsers = this.groupToUsers.get(group);
      for (const otherUser of groupUsers) {
        if (otherUser !== user) {
          relatedUsers.add(otherUser);
        }
      }
    }
    
    return [...relatedUsers];
  }
  
  // íŠ¹ì • ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë“¤ ì°¾ê¸° (êµì§‘í•©)
  findUsersWithAllGroups(groups) {
    if (groups.length === 0) return [];
    
    let result = new Set(this.getGroupUsers(groups[0]));
    
    for (let i = 1; i < groups.length; i++) {
      const groupUsers = new Set(this.getGroupUsers(groups[i]));
      result = new Set([...result].filter(user => groupUsers.has(user)));
    }
    
    return [...result];
  }
  
  // í†µê³„ ì •ë³´
  getStats() {
    return {
      totalUsers: this.users.size,
      totalGroups: this.groups.size,
      avgGroupsPerUser: this.users.size > 0 ? 
        [...this.userToGroups.values()].reduce((sum, groups) => sum + groups.size, 0) / this.users.size : 0,
      avgUsersPerGroup: this.groups.size > 0 ?
        [...this.groupToUsers.values()].reduce((sum, users) => sum + users.size, 0) / this.groups.size : 0
    };
  }
  
  // ê´€ê³„ ì¶œë ¥
  toString() {
    const result = [];
    result.push('=== Users and their Groups ===');
    for (const [user, groups] of this.userToGroups) {
      result.push(`${user}: [${[...groups].join(', ')}]`);
    }
    result.push('\n=== Groups and their Users ===');
    for (const [group, users] of this.groupToUsers) {
      result.push(`${group}: [${[...users].join(', ')}]`);
    }
    return result.join('\n');
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const rm = new RelationshipManager();

// ì‚¬ìš©ìì™€ ê·¸ë£¹ ê´€ê³„ ì„¤ì •
rm.addUserToGroup('Alice', 'Developers');
rm.addUserToGroup('Alice', 'Managers');
rm.addUserToGroup('Bob', 'Developers');
rm.addUserToGroup('Charlie', 'Designers');
rm.addUserToGroup('Charlie', 'Managers');

console.log('Aliceì˜ ê·¸ë£¹:', rm.getUserGroups('Alice')); // ['Developers', 'Managers']
console.log('Developers ê·¸ë£¹ ë©¤ë²„:', rm.getGroupUsers('Developers')); // ['Alice', 'Bob']
console.log('Aliceì™€ ê°™ì€ ê·¸ë£¹ì˜ ì‚¬ìš©ìë“¤:', rm.findUsersInSameGroups('Alice')); // ['Bob', 'Charlie']

// ë³µìˆ˜ ê·¸ë£¹ì— ëª¨ë‘ ì†í•œ ì‚¬ìš©ì ì°¾ê¸°
console.log('Developersì™€ Managers ëª¨ë‘ì— ì†í•œ ì‚¬ìš©ì:', rm.findUsersWithAllGroups(['Developers', 'Managers'])); // ['Alice']

console.log('í†µê³„:', rm.getStats());
console.log(rm.toString());
```